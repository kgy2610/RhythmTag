<!-- blog/templates/blog/post_list.html -->

{% load static %}
<!DOCTYPE html>
<html lang="ko">
    <head>
        <meta charset="UTF-8" />
        <title>RhythmTag</title>
        <link rel="stylesheet" href="{% static 'blog/css/common.css' %}">
        <link rel="stylesheet" href="{% static 'blog/css/post_list.css' %}">
    </head>
    <body>
        {% if user.is_authenticated and not user_has_blog %}
            <div style="text-align: center; padding: 40px; background-color: #f8f9fa; margin: 20px 0; border-radius: 8px;">
                <h3>블로그가 없습니다</h3>
                <p>나만의 블로그를 만들어 글을 작성해보세요!</p>
                <a href="{% url 'blog_create' %}" style="padding: 12px 24px; background-color: #007bff; color: white; text-decoration: none; border-radius: 4px; font-size: 16px;">블로그 생성하기</a>
            </div>
        {% endif %}
        
        <header>
            <div id="header">
                <div id="logo">
                    <img src="{% static 'blog/images/logo.png' %}" alt="RhythmTag">
                </div>
                <div class="menu">
                    <div id="user">
                        <img src="{% static 'blog/images/user.png' %}" alt="내 정보">
                    </div>
                    <div id="menu">
                        <img src="{% static 'blog/images/menu.png' %}" alt="메뉴">
                    </div>
                </div>
            </div>
            <hr>
        </header>

        <div class="search-bar">
            <input type="text" placeholder="검색어를 입력하세요(제목, 태그)">
        </div>

        <div class="blog-name">
            {% if user.is_authenticated and user_has_blog %}
                <p>#{{ user_blog.blog_name }}</p>
            {% else %}
                <p>#내 블로그 이름</p>
            {% endif %}
        </div>

        <section id="category">
            <div class="category-btn">
                <input type="radio" name="filter" id="MyPost" checked>
                <label for="MyPost">내가 작성한 글</label>

                <input type="radio" name="filter" id="follow">
                <label for="follow">팔로워/팔로잉</label>

                <input type="radio" name="filter" id="famous">
                <label for="famous">인기가 많은 글</label>
            </div>
            <div class="write">
                <p><a href="{% url 'post_write' %}">새 글 쓰기</a></p>
            </div>
        </section>

        <section id="post-list">
            {% if posts %}
                {% for post in posts %}
                <div class="post-card">
                    <a href="{% url 'post_detail' post.id %}">
                        <div id="thumnail">
                            {% if post.youtube_thumbnail_url %}
                                <img src="{{ post.youtube_thumbnail_url }}" alt="썸네일">
                            {% else %}
                                <p>유효하지 않은 유튜브 링크</p>
                            {% endif %}
                        </div>
                        <div id="info">
                            <div id="userName">{{ post.user.username }}</div>
                            <div id="likes">❤️ {{ post.like_count }}</div>
                        </div>
                        <div id="post-content">
                            {{ post.content|truncatechars:20 }}
                        </div>
                        <div id="tags">
                            {% for tag in post.tags.all %}#{{ tag.name }} {% endfor %}
                        </div>
                    </a>
                </div>
                {% endfor %}
            {% else %}
                <div style="text-align: center; padding: 40px;">
                    <p>아직 게시글이 없습니다.</p>
                    {% if user.is_authenticated %}
                        <a href="{% url 'post_write' %}" style="padding: 10px 20px; background-color: #007bff; color: white; text-decoration: none; border-radius: 4px;">첫 번째 글 작성하기</a>
                    {% endif %}
                </div>
            {% endif %}
        </section>
    </body>
</html>